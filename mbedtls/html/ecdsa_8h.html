<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>mbed TLS v2.2.0: ecdsa.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">mbed TLS v2.2.0
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="../../index.html"><span>Documentation&#160;Home</span></a></li>
      <li><a href="http://www.silabs.com"><span>silabs.com</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_23ec12649285f9fabf3a6b7380226c28.html">util</a></li><li class="navelem"><a class="el" href="dir_ac655dac275e92e155b3b8154f8d56ac.html">third_party</a></li><li class="navelem"><a class="el" href="dir_82ed8909db942c5e5a6d4c509258108c.html">mbedtls</a></li><li class="navelem"><a class="el" href="dir_80781323b3d5b22a7a92816d0b03a427.html">include</a></li><li class="navelem"><a class="el" href="dir_bfa12f6c3534ba28ab5f186c4907ef1a.html">mbedtls</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ecdsa.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Elliptic curve DSA. </p>
<p>Copyright (C) 2006-2015, ARM Limited, All Rights Reserved SPDX-License-Identifier: Apache-2.0</p>
<p>Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at</p>
<p><a href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a></p>
<p>Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License.</p>
<p>This file is part of mbed TLS (<a href="https://tls.mbed.org">https://tls.mbed.org</a>) </p>

<p>Definition in file <a class="el" href="ecdsa_8h_source.html">ecdsa.h</a>.</p>
</div><div class="textblock"><code>#include &quot;<a class="el" href="ecp_8h_source.html">ecp.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="md_8h_source.html">md.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for ecdsa.h:</div>
<div class="dyncontent">
<div class="center"><img src="ecdsa_8h__incl.png" border="0" usemap="#ecdsa_8h" alt=""/></div>
<map name="ecdsa_8h" id="ecdsa_8h">
<area shape="rect" id="node3" href="ecp_8h.html" title="Elliptic curves over GF(p) " alt="" coords="381,80,435,107"/>
<area shape="rect" id="node36" href="md_8h.html" title="md.h" alt="" coords="460,80,511,107"/>
<area shape="rect" id="node5" href="bignum_8h.html" title="Multi&#45;precision integer library. " alt="" coords="373,155,448,181"/>
<area shape="rect" id="node22" href="ecp__alt_8h.html" title="Elliptic curves over GF(p) " alt="" coords="275,155,349,181"/>
<area shape="rect" id="node7" href="config-sl-crypto-all-acceleration_8h.html" title="config&#45;sl&#45;crypto&#45;all\l&#45;acceleration.h" alt="" coords="59,305,185,346"/>
<area shape="rect" id="node11" href="config_8h.html" title="Compatibility names (set of defines) " alt="" coords="49,395,167,421"/>
<area shape="rect" id="node13" href="check__config_8h.html" title="Consistency checks for configuration options. " alt="" coords="5,469,115,496"/>
<area shape="rect" id="node25" href="cryptodrv_8h.html" title="cryptodrv.h" alt="" coords="280,229,365,256"/>
<area shape="rect" id="node29" href="mbedtls__ecode_8h.html" title="Silicon Labs specific mbedtls error code definitions. " alt="" coords="262,312,383,339"/>
</map>
</div>
</div>
<p><a href="ecdsa_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:aeb07d11aef4d847c5cc5cfba49547136"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecdsa_8h.html#aeb07d11aef4d847c5cc5cfba49547136">MBEDTLS_ECDSA_MAX_LEN</a>&#160;&#160;&#160;( 3 + 2 * ( 3 + <a class="el" href="group__sl__crypto__ecp.html#gaba9fdfc8a8dd423182616e5708abf607">MBEDTLS_ECP_MAX_BYTES</a> ) )</td></tr>
<tr class="memdesc:aeb07d11aef4d847c5cc5cfba49547136"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum size of an ECDSA signature in bytes.  <a href="#aeb07d11aef4d847c5cc5cfba49547136">More...</a><br /></td></tr>
<tr class="separator:aeb07d11aef4d847c5cc5cfba49547136"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a86ad4c743272c83310c20585ec7a182f"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="structmbedtls__ecp__keypair.html">mbedtls_ecp_keypair</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecdsa_8h.html#a86ad4c743272c83310c20585ec7a182f">mbedtls_ecdsa_context</a></td></tr>
<tr class="memdesc:a86ad4c743272c83310c20585ec7a182f"><td class="mdescLeft">&#160;</td><td class="mdescRight">ECDSA context structure.  <a href="#a86ad4c743272c83310c20585ec7a182f">More...</a><br /></td></tr>
<tr class="separator:a86ad4c743272c83310c20585ec7a182f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:af10f6fda2169862871d0ac07555c8641"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecdsa_8h.html#af10f6fda2169862871d0ac07555c8641">mbedtls_ecdsa_sign</a> (<a class="el" href="structmbedtls__ecp__group.html">mbedtls_ecp_group</a> *grp, <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *r, <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *s, const <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *d, const unsigned char *buf, size_t blen, int(*f_rng)(void *, unsigned char *, size_t), void *p_rng)</td></tr>
<tr class="memdesc:af10f6fda2169862871d0ac07555c8641"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute ECDSA signature of a previously hashed message.  <a href="#af10f6fda2169862871d0ac07555c8641">More...</a><br /></td></tr>
<tr class="separator:af10f6fda2169862871d0ac07555c8641"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2292032f359fda59a7fd14911cc56f38"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecdsa_8h.html#a2292032f359fda59a7fd14911cc56f38">mbedtls_ecdsa_verify</a> (<a class="el" href="structmbedtls__ecp__group.html">mbedtls_ecp_group</a> *grp, const unsigned char *buf, size_t blen, const <a class="el" href="structmbedtls__ecp__point.html">mbedtls_ecp_point</a> *Q, const <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *r, const <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *s)</td></tr>
<tr class="memdesc:a2292032f359fda59a7fd14911cc56f38"><td class="mdescLeft">&#160;</td><td class="mdescRight">Verify ECDSA signature of a previously hashed message.  <a href="#a2292032f359fda59a7fd14911cc56f38">More...</a><br /></td></tr>
<tr class="separator:a2292032f359fda59a7fd14911cc56f38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76da70289de1f746ad9cce1eadf7b135"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecdsa_8h.html#a76da70289de1f746ad9cce1eadf7b135">mbedtls_ecdsa_write_signature</a> (<a class="el" href="ecdsa_8h.html#a86ad4c743272c83310c20585ec7a182f">mbedtls_ecdsa_context</a> *ctx, <a class="el" href="md_8h.html#a219313cb40503ec3e34a857ab98b2296">mbedtls_md_type_t</a> md_alg, const unsigned char *hash, size_t hlen, unsigned char *sig, size_t *slen, int(*f_rng)(void *, unsigned char *, size_t), void *p_rng)</td></tr>
<tr class="memdesc:a76da70289de1f746ad9cce1eadf7b135"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute ECDSA signature and write it to buffer, serialized as defined in RFC 4492 page 20.  <a href="#a76da70289de1f746ad9cce1eadf7b135">More...</a><br /></td></tr>
<tr class="separator:a76da70289de1f746ad9cce1eadf7b135"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8085ade3e127118aa615f65cb1d393d5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecdsa_8h.html#a8085ade3e127118aa615f65cb1d393d5">mbedtls_ecdsa_read_signature</a> (<a class="el" href="ecdsa_8h.html#a86ad4c743272c83310c20585ec7a182f">mbedtls_ecdsa_context</a> *ctx, const unsigned char *hash, size_t hlen, const unsigned char *sig, size_t slen)</td></tr>
<tr class="memdesc:a8085ade3e127118aa615f65cb1d393d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read and verify an ECDSA signature.  <a href="#a8085ade3e127118aa615f65cb1d393d5">More...</a><br /></td></tr>
<tr class="separator:a8085ade3e127118aa615f65cb1d393d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab909bd06650e761e9fd176a86bd1ce17"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecdsa_8h.html#ab909bd06650e761e9fd176a86bd1ce17">mbedtls_ecdsa_genkey</a> (<a class="el" href="ecdsa_8h.html#a86ad4c743272c83310c20585ec7a182f">mbedtls_ecdsa_context</a> *ctx, <a class="el" href="group__sl__crypto__ecp.html#gaf79e530ea8f8416480f805baa20b1a2d">mbedtls_ecp_group_id</a> gid, int(*f_rng)(void *, unsigned char *, size_t), void *p_rng)</td></tr>
<tr class="memdesc:ab909bd06650e761e9fd176a86bd1ce17"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate an ECDSA keypair on the given curve.  <a href="#ab909bd06650e761e9fd176a86bd1ce17">More...</a><br /></td></tr>
<tr class="separator:ab909bd06650e761e9fd176a86bd1ce17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6de8efd872cfe1bc2ee93b4a5584226c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecdsa_8h.html#a6de8efd872cfe1bc2ee93b4a5584226c">mbedtls_ecdsa_from_keypair</a> (<a class="el" href="ecdsa_8h.html#a86ad4c743272c83310c20585ec7a182f">mbedtls_ecdsa_context</a> *ctx, const <a class="el" href="structmbedtls__ecp__keypair.html">mbedtls_ecp_keypair</a> *key)</td></tr>
<tr class="memdesc:a6de8efd872cfe1bc2ee93b4a5584226c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set an ECDSA context from an EC key pair.  <a href="#a6de8efd872cfe1bc2ee93b4a5584226c">More...</a><br /></td></tr>
<tr class="separator:a6de8efd872cfe1bc2ee93b4a5584226c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca644ee02921388fdc42eb06377f4b62"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecdsa_8h.html#aca644ee02921388fdc42eb06377f4b62">mbedtls_ecdsa_init</a> (<a class="el" href="ecdsa_8h.html#a86ad4c743272c83310c20585ec7a182f">mbedtls_ecdsa_context</a> *ctx)</td></tr>
<tr class="memdesc:aca644ee02921388fdc42eb06377f4b62"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize context.  <a href="#aca644ee02921388fdc42eb06377f4b62">More...</a><br /></td></tr>
<tr class="separator:aca644ee02921388fdc42eb06377f4b62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28dd93cb376a51cce39f062858c1c186"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecdsa_8h.html#a28dd93cb376a51cce39f062858c1c186">mbedtls_ecdsa_free</a> (<a class="el" href="ecdsa_8h.html#a86ad4c743272c83310c20585ec7a182f">mbedtls_ecdsa_context</a> *ctx)</td></tr>
<tr class="memdesc:a28dd93cb376a51cce39f062858c1c186"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free context.  <a href="#a28dd93cb376a51cce39f062858c1c186">More...</a><br /></td></tr>
<tr class="separator:a28dd93cb376a51cce39f062858c1c186"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="aeb07d11aef4d847c5cc5cfba49547136"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MBEDTLS_ECDSA_MAX_LEN&#160;&#160;&#160;( 3 + 2 * ( 3 + <a class="el" href="group__sl__crypto__ecp.html#gaba9fdfc8a8dd423182616e5708abf607">MBEDTLS_ECP_MAX_BYTES</a> ) )</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum size of an ECDSA signature in bytes. </p>

<p>Definition at line <a class="el" href="ecdsa_8h_source.html#l00047">47</a> of file <a class="el" href="ecdsa_8h_source.html">ecdsa.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="a86ad4c743272c83310c20585ec7a182f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="structmbedtls__ecp__keypair.html">mbedtls_ecp_keypair</a> <a class="el" href="ecdsa_8h.html#a86ad4c743272c83310c20585ec7a182f">mbedtls_ecdsa_context</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>ECDSA context structure. </p>

<p>Definition at line <a class="el" href="ecdsa_8h_source.html#l00052">52</a> of file <a class="el" href="ecdsa_8h_source.html">ecdsa.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a28dd93cb376a51cce39f062858c1c186"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mbedtls_ecdsa_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ecdsa_8h.html#a86ad4c743272c83310c20585ec7a182f">mbedtls_ecdsa_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Free context. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>Context to free </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a6de8efd872cfe1bc2ee93b4a5584226c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ecdsa_from_keypair </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ecdsa_8h.html#a86ad4c743272c83310c20585ec7a182f">mbedtls_ecdsa_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmbedtls__ecp__keypair.html">mbedtls_ecp_keypair</a> *&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set an ECDSA context from an EC key pair. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>ECDSA context to set </td></tr>
    <tr><td class="paramname">key</td><td>EC key to use</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, or a MBEDTLS_ERR_ECP_XXX code. </dd></dl>

</div>
</div>
<a class="anchor" id="ab909bd06650e761e9fd176a86bd1ce17"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ecdsa_genkey </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ecdsa_8h.html#a86ad4c743272c83310c20585ec7a182f">mbedtls_ecdsa_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__sl__crypto__ecp.html#gaf79e530ea8f8416480f805baa20b1a2d">mbedtls_ecp_group_id</a>&#160;</td>
          <td class="paramname"><em>gid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(void *, unsigned char *, size_t)&#160;</td>
          <td class="paramname"><em>f_rng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p_rng</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate an ECDSA keypair on the given curve. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>ECDSA context in which the keypair should be stored </td></tr>
    <tr><td class="paramname">gid</td><td>Group (elliptic curve) to use. One of the various MBEDTLS_ECP_DP_XXX macros depending on configuration. </td></tr>
    <tr><td class="paramname">f_rng</td><td>RNG function </td></tr>
    <tr><td class="paramname">p_rng</td><td>RNG parameter</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, or a MBEDTLS_ERR_ECP_XXX code. </dd></dl>

</div>
</div>
<a class="anchor" id="aca644ee02921388fdc42eb06377f4b62"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mbedtls_ecdsa_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ecdsa_8h.html#a86ad4c743272c83310c20585ec7a182f">mbedtls_ecdsa_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize context. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>Context to initialize </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a8085ade3e127118aa615f65cb1d393d5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ecdsa_read_signature </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ecdsa_8h.html#a86ad4c743272c83310c20585ec7a182f">mbedtls_ecdsa_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>hash</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>hlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>sig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>slen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read and verify an ECDSA signature. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>ECDSA context </td></tr>
    <tr><td class="paramname">hash</td><td>Message hash </td></tr>
    <tr><td class="paramname">hlen</td><td>Size of hash </td></tr>
    <tr><td class="paramname">sig</td><td>Signature to read and verify </td></tr>
    <tr><td class="paramname">slen</td><td>Size of sig</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, MBEDTLS_ERR_ECP_BAD_INPUT_DATA if signature is invalid, MBEDTLS_ERR_ECP_SIG_LEN_MISMATCH if the signature is valid but its actual length is less than siglen, or a MBEDTLS_ERR_ECP_XXX or MBEDTLS_ERR_MPI_XXX error code </dd></dl>

</div>
</div>
<a class="anchor" id="af10f6fda2169862871d0ac07555c8641"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ecdsa_sign </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecp__group.html">mbedtls_ecp_group</a> *&#160;</td>
          <td class="paramname"><em>grp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>blen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(void *, unsigned char *, size_t)&#160;</td>
          <td class="paramname"><em>f_rng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p_rng</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute ECDSA signature of a previously hashed message. </p>
<dl class="section note"><dt>Note</dt><dd>The deterministic version is usually prefered.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">grp</td><td>ECP group </td></tr>
    <tr><td class="paramname">r</td><td>First output integer </td></tr>
    <tr><td class="paramname">s</td><td>Second output integer </td></tr>
    <tr><td class="paramname">d</td><td>Private signing key </td></tr>
    <tr><td class="paramname">buf</td><td>Message hash </td></tr>
    <tr><td class="paramname">blen</td><td>Length of buf </td></tr>
    <tr><td class="paramname">f_rng</td><td>RNG function </td></tr>
    <tr><td class="paramname">p_rng</td><td>RNG parameter</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or a MBEDTLS_ERR_ECP_XXX or MBEDTLS_MPI_XXX error code </dd></dl>

</div>
</div>
<a class="anchor" id="a2292032f359fda59a7fd14911cc56f38"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ecdsa_verify </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ecp__group.html">mbedtls_ecp_group</a> *&#160;</td>
          <td class="paramname"><em>grp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>blen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmbedtls__ecp__point.html">mbedtls_ecp_point</a> *&#160;</td>
          <td class="paramname"><em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmbedtls__mpi.html">mbedtls_mpi</a> *&#160;</td>
          <td class="paramname"><em>s</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Verify ECDSA signature of a previously hashed message. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">grp</td><td>ECP group </td></tr>
    <tr><td class="paramname">buf</td><td>Message hash </td></tr>
    <tr><td class="paramname">blen</td><td>Length of buf </td></tr>
    <tr><td class="paramname">Q</td><td>Public key to use for verification </td></tr>
    <tr><td class="paramname">r</td><td>First integer of the signature </td></tr>
    <tr><td class="paramname">s</td><td>Second integer of the signature</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, MBEDTLS_ERR_ECP_BAD_INPUT_DATA if signature is invalid or a MBEDTLS_ERR_ECP_XXX or MBEDTLS_MPI_XXX error code </dd></dl>

</div>
</div>
<a class="anchor" id="a76da70289de1f746ad9cce1eadf7b135"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ecdsa_write_signature </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ecdsa_8h.html#a86ad4c743272c83310c20585ec7a182f">mbedtls_ecdsa_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="md_8h.html#a219313cb40503ec3e34a857ab98b2296">mbedtls_md_type_t</a>&#160;</td>
          <td class="paramname"><em>md_alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>hash</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>hlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>sig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>slen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(void *, unsigned char *, size_t)&#160;</td>
          <td class="paramname"><em>f_rng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p_rng</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute ECDSA signature and write it to buffer, serialized as defined in RFC 4492 page 20. </p>
<p>(Not thread-safe to use same context in multiple threads)</p>
<dl class="section note"><dt>Note</dt><dd>The deterministice version (RFC 6979) is used if MBEDTLS_ECDSA_DETERMINISTIC is defined.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>ECDSA context </td></tr>
    <tr><td class="paramname">md_alg</td><td>Algorithm that was used to hash the message </td></tr>
    <tr><td class="paramname">hash</td><td>Message hash </td></tr>
    <tr><td class="paramname">hlen</td><td>Length of hash </td></tr>
    <tr><td class="paramname">sig</td><td>Buffer that will hold the signature </td></tr>
    <tr><td class="paramname">slen</td><td>Length of the signature written </td></tr>
    <tr><td class="paramname">f_rng</td><td>RNG function </td></tr>
    <tr><td class="paramname">p_rng</td><td>RNG parameter</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The "sig" buffer must be at least as large as twice the size of the curve used, plus 9 (eg. 73 bytes if a 256-bit curve is used). MBEDTLS_ECDSA_MAX_LEN is always safe.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or a MBEDTLS_ERR_ECP_XXX, MBEDTLS_ERR_MPI_XXX or MBEDTLS_ERR_ASN1_XXX error code </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Jun 13 2016 11:17:18 for mbed TLS v2.2.0 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
