<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>mbed TLS v2.2.0: Silicon Labs True Random Number Generator Plugin</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">mbed TLS v2.2.0
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="../../index.html"><span>Documentation&#160;Home</span></a></li>
      <li><a href="http://www.silabs.com"><span>silabs.com</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Silicon Labs True Random Number Generator Plugin<div class="ingroups"><a class="el" href="group__rng__module.html">Random number generator (RNG) module</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>True Random Number Generator (TRNG) driver for Silicon Labs devices. </p>
<p>The EFR32xG12 and EFM32xG12 and newer Silicon Labs devices contains a True Random Number Generator (TRNG) peripheral. The TRNG is a non-deterministic random number generator based on a full hardware solution. The TRNG contains a 64 x 32-bit FIFO for reading out random numbers.</p>
<p>The samples from entropy source within the TRNG are monitored permanently by 4 built in tests that detect issues with the noise source. The tests are specified in NIST-800-90B and AIS31. The tests that are always checking the entropy source are "Repetition Count Test", "Adaptive Proportion Test
(64-sample window)", "Adaptive Proportion Test (4096-sample window)" and the "AIS31 Online Test".</p>
<p>In addition the TRNG has options for running startup tests. When these tests are enabled the TRNG FIFO will not contains any data before all the startup tests have passed. There are 4 TRNG startup tests, 3 of the tests are specified in NIST-800-90B. These are the "Repetition Count Test", "Adaptive
Proportion Test (64-sample window)" and "Adaptive Proportion Test
(4096-sample window)". The last startup test is the AIS31 startup test. By default when using this driver all the startup tests are enabled.</p>
<p>The TRNG module implements an entropy source plugin module for mbed TLS that can be used in applications needing random numbers or indirectly using mbed TLS modules that depend on the random number generation interfaces of mbed TLS. The define <a class="el" href="group__sl__crypto__config.html#gac3559847374ce3d83352e832154e26fe">MBEDTLS_TRNG_C</a> will compile the TRNG module. The TRNG is enbabled as an mbed TLS entropy source by defining <a class="el" href="group__sl__crypto__config.html#ga843b10b6fc14b951a8148485576f88fc">MBEDTLS_ENTROPY_ALT</a>, <a class="el" href="group__sl__crypto__config.html#gac3b75ecc9e62e960466bc55c3ddc934e">MBEDTLS_ENTROPY_INIT_ALT</a> and <a class="el" href="group__sl__crypto__config.html#gab4cf929e192194586970deb5a8579271">MBEDTLS_ENTROPY_FREE_ALT</a>. The TRNG functions are declared in the '<a class="el" href="trng_8h.html" title="True Random Number Generator (TRNG) driver for Silicon Labs devices. ">mbedtls/sl_crypto/include/trng.h</a>' file. </p>
<div class="dynheader">
Collaboration diagram for Silicon Labs True Random Number Generator Plugin:</div>
<div class="dyncontent">
<center><table><tr><td><img src="group__sl__crypto__trng.png" border="0" alt="" usemap="#group____sl____crypto____trng"/>
<map name="group____sl____crypto____trng" id="group____sl____crypto____trng">
<area shape="rect" id="node2" href="group__rng__module.html" title="The Random number generator (RNG) module provides random number generation, see ctr_dbrg_random(). " alt="" coords="6,5,181,46"/>
</map>
</td></tr></table></center>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmbedtls__trng__context.html">mbedtls_trng_context</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">TRNG context structure.  <a href="structmbedtls__trng__context.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:gaa10b5a545120bfba4c93015b023c1ebb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sl__crypto__trng.html#gaa10b5a545120bfba4c93015b023c1ebb">MBEDTLS_ERR_TRNG_CONDITIONING_TEST_FAILED</a>&#160;&#160;&#160;((int)<a class="el" href="mbedtls__ecode_8h.html#a427a9c812380331dc27621c07abcbbbb">MBEDTLS_ERR_TRNG_BASE</a> | 0x00000001)</td></tr>
<tr class="memdesc:gaa10b5a545120bfba4c93015b023c1ebb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Conditioning test failed.  <a href="#gaa10b5a545120bfba4c93015b023c1ebb">More...</a><br /></td></tr>
<tr class="separator:gaa10b5a545120bfba4c93015b023c1ebb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga22001b88271612caad4c2f36248ba242"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sl__crypto__trng.html#ga22001b88271612caad4c2f36248ba242">MBEDTLS_ERR_TRNG_NO_DATA</a>&#160;&#160;&#160;((int)<a class="el" href="mbedtls__ecode_8h.html#a427a9c812380331dc27621c07abcbbbb">MBEDTLS_ERR_TRNG_BASE</a> | 0x00000002)</td></tr>
<tr class="memdesc:ga22001b88271612caad4c2f36248ba242"><td class="mdescLeft">&#160;</td><td class="mdescRight">No data received in the TRNG FIFO.  <a href="#ga22001b88271612caad4c2f36248ba242">More...</a><br /></td></tr>
<tr class="separator:ga22001b88271612caad4c2f36248ba242"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga212f3d8f9ff4bcb5de2ec09a38b4cbc3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sl__crypto__trng.html#ga212f3d8f9ff4bcb5de2ec09a38b4cbc3">MBEDTLS_ERR_TRNG_REPETITION_COUNT_TEST_FAILED</a>&#160;&#160;&#160;((int)<a class="el" href="mbedtls__ecode_8h.html#a427a9c812380331dc27621c07abcbbbb">MBEDTLS_ERR_TRNG_BASE</a> | 0x00000003)</td></tr>
<tr class="memdesc:ga212f3d8f9ff4bcb5de2ec09a38b4cbc3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Repetition Count test failed.  <a href="#ga212f3d8f9ff4bcb5de2ec09a38b4cbc3">More...</a><br /></td></tr>
<tr class="separator:ga212f3d8f9ff4bcb5de2ec09a38b4cbc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga209fcc9eb76501ac1ed4537ecf4fd63e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sl__crypto__trng.html#ga209fcc9eb76501ac1ed4537ecf4fd63e">MBEDTLS_ERR_TRNG_ADAPTIVE_PROPORTION_TEST_64_FAILED</a>&#160;&#160;&#160;((int)<a class="el" href="mbedtls__ecode_8h.html#a427a9c812380331dc27621c07abcbbbb">MBEDTLS_ERR_TRNG_BASE</a> | 0x00000004)</td></tr>
<tr class="memdesc:ga209fcc9eb76501ac1ed4537ecf4fd63e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adaptive Proportion test over 64 samples failed.  <a href="#ga209fcc9eb76501ac1ed4537ecf4fd63e">More...</a><br /></td></tr>
<tr class="separator:ga209fcc9eb76501ac1ed4537ecf4fd63e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga66f2275b76a973af2e322f7483b88249"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sl__crypto__trng.html#ga66f2275b76a973af2e322f7483b88249">MBEDTLS_ERR_TRNG_ADAPTIVE_PROPORTION_TEST_4096_FAILED</a>&#160;&#160;&#160;((int)<a class="el" href="mbedtls__ecode_8h.html#a427a9c812380331dc27621c07abcbbbb">MBEDTLS_ERR_TRNG_BASE</a> | 0x00000005)</td></tr>
<tr class="memdesc:ga66f2275b76a973af2e322f7483b88249"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adaptive Proportion test over 4096 samples failed.  <a href="#ga66f2275b76a973af2e322f7483b88249">More...</a><br /></td></tr>
<tr class="separator:ga66f2275b76a973af2e322f7483b88249"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga71bc27982f6fa984ad45daf6bc7f898f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sl__crypto__trng.html#ga71bc27982f6fa984ad45daf6bc7f898f">MBEDTLS_ERR_TRNG_NOISE_ALARM</a>&#160;&#160;&#160;((int)<a class="el" href="mbedtls__ecode_8h.html#a427a9c812380331dc27621c07abcbbbb">MBEDTLS_ERR_TRNG_BASE</a> | 0x00000006)</td></tr>
<tr class="memdesc:ga71bc27982f6fa984ad45daf6bc7f898f"><td class="mdescLeft">&#160;</td><td class="mdescRight">AIS31 test noise alarm.  <a href="#ga71bc27982f6fa984ad45daf6bc7f898f">More...</a><br /></td></tr>
<tr class="separator:ga71bc27982f6fa984ad45daf6bc7f898f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga39f2b36f88c3c5119e48d68d7059226a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sl__crypto__trng.html#ga39f2b36f88c3c5119e48d68d7059226a">MBEDTLS_ERR_TRNG_PRELIMINARY_NOISE_ALARM</a>&#160;&#160;&#160;((int)<a class="el" href="mbedtls__ecode_8h.html#a427a9c812380331dc27621c07abcbbbb">MBEDTLS_ERR_TRNG_BASE</a> | 0x00000007)</td></tr>
<tr class="memdesc:ga39f2b36f88c3c5119e48d68d7059226a"><td class="mdescLeft">&#160;</td><td class="mdescRight">AIS31 test Preliminary Noise alarm.  <a href="#ga39f2b36f88c3c5119e48d68d7059226a">More...</a><br /></td></tr>
<tr class="separator:ga39f2b36f88c3c5119e48d68d7059226a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga846a87535364a7764897e35dcd362401"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sl__crypto__trng.html#ga846a87535364a7764897e35dcd362401">mbedtls_trng_init</a> (<a class="el" href="structmbedtls__trng__context.html">mbedtls_trng_context</a> *ctx)</td></tr>
<tr class="memdesc:ga846a87535364a7764897e35dcd362401"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize TRNG context.  <a href="#ga846a87535364a7764897e35dcd362401">More...</a><br /></td></tr>
<tr class="separator:ga846a87535364a7764897e35dcd362401"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga105f7fb57c7a0843f4b750c54636c53b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sl__crypto__trng.html#ga105f7fb57c7a0843f4b750c54636c53b">mbedtls_trng_free</a> (<a class="el" href="structmbedtls__trng__context.html">mbedtls_trng_context</a> *ctx)</td></tr>
<tr class="memdesc:ga105f7fb57c7a0843f4b750c54636c53b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free TRNG context.  <a href="#ga105f7fb57c7a0843f4b750c54636c53b">More...</a><br /></td></tr>
<tr class="separator:ga105f7fb57c7a0843f4b750c54636c53b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7ad4ef01d236b535ab156175708f1eeb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sl__crypto__trng.html#ga7ad4ef01d236b535ab156175708f1eeb">mbedtls_trng_set_key</a> (<a class="el" href="structmbedtls__trng__context.html">mbedtls_trng_context</a> *ctx, const unsigned char *key)</td></tr>
<tr class="memdesc:ga7ad4ef01d236b535ab156175708f1eeb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check the TRNG conditioning function.  <a href="#ga7ad4ef01d236b535ab156175708f1eeb">More...</a><br /></td></tr>
<tr class="separator:ga7ad4ef01d236b535ab156175708f1eeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga987bc2a769eca92ef81c865e95f26fb8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sl__crypto__trng.html#ga987bc2a769eca92ef81c865e95f26fb8">mbedtls_trng_check_conditioning</a> (<a class="el" href="structmbedtls__trng__context.html">mbedtls_trng_context</a> *ctx)</td></tr>
<tr class="memdesc:ga987bc2a769eca92ef81c865e95f26fb8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check the TRNG conditioning function.  <a href="#ga987bc2a769eca92ef81c865e95f26fb8">More...</a><br /></td></tr>
<tr class="separator:ga987bc2a769eca92ef81c865e95f26fb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9dc92e7f58972d20cff0738a8eb404ec"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sl__crypto__trng.html#ga9dc92e7f58972d20cff0738a8eb404ec">mbedtls_trng_check_entropy</a> (<a class="el" href="structmbedtls__trng__context.html">mbedtls_trng_context</a> *ctx)</td></tr>
<tr class="memdesc:ga9dc92e7f58972d20cff0738a8eb404ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check the TRNG entropy source is producing random data.  <a href="#ga9dc92e7f58972d20cff0738a8eb404ec">More...</a><br /></td></tr>
<tr class="separator:ga9dc92e7f58972d20cff0738a8eb404ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac8319b2bf9b23885f5401a98f0d16db1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sl__crypto__trng.html#gac8319b2bf9b23885f5401a98f0d16db1">mbedtls_trng_poll</a> (<a class="el" href="structmbedtls__trng__context.html">mbedtls_trng_context</a> *ctx, unsigned char *output, size_t len, size_t *olen)</td></tr>
<tr class="memdesc:gac8319b2bf9b23885f5401a98f0d16db1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Poll for entropy data.  <a href="#gac8319b2bf9b23885f5401a98f0d16db1">More...</a><br /></td></tr>
<tr class="separator:gac8319b2bf9b23885f5401a98f0d16db1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga76cbaf4739ffb9abfb88f341c6918548"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sl__crypto__trng.html#ga76cbaf4739ffb9abfb88f341c6918548">mbedtls_trng_soft_reset</a> (<a class="el" href="structmbedtls__trng__context.html">mbedtls_trng_context</a> *ctx)</td></tr>
<tr class="memdesc:ga76cbaf4739ffb9abfb88f341c6918548"><td class="mdescLeft">&#160;</td><td class="mdescRight">Execute TRNG soft reset.  <a href="#ga76cbaf4739ffb9abfb88f341c6918548">More...</a><br /></td></tr>
<tr class="separator:ga76cbaf4739ffb9abfb88f341c6918548"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="ga66f2275b76a973af2e322f7483b88249"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MBEDTLS_ERR_TRNG_ADAPTIVE_PROPORTION_TEST_4096_FAILED&#160;&#160;&#160;((int)<a class="el" href="mbedtls__ecode_8h.html#a427a9c812380331dc27621c07abcbbbb">MBEDTLS_ERR_TRNG_BASE</a> | 0x00000005)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adaptive Proportion test over 4096 samples failed. </p>
<p>The adaptive proportion test is designed to detect a large loss of entropy that might occur as a result of some physical failure or environmental change affecting the TRNG.</p>
<p>The test will fail when a 2 bit sample from the TRNG is repeated an unusual amount of times within a window of 4096 bits. The adaptive proportion test is further described in NIST-800-90B.</p>
<p>If an application detects this error then the TRNG should be reset. The adaptive proportion test over 4096 samples is always enabled. </p>

<p>Definition at line <a class="el" href="trng_8h_source.html#l00116">116</a> of file <a class="el" href="trng_8h_source.html">trng.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga209fcc9eb76501ac1ed4537ecf4fd63e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MBEDTLS_ERR_TRNG_ADAPTIVE_PROPORTION_TEST_64_FAILED&#160;&#160;&#160;((int)<a class="el" href="mbedtls__ecode_8h.html#a427a9c812380331dc27621c07abcbbbb">MBEDTLS_ERR_TRNG_BASE</a> | 0x00000004)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adaptive Proportion test over 64 samples failed. </p>
<p>The adaptive proportion test is designed to detect a large loss of entropy that might occur as a result of some physical failure or environmental change affecting the TRNG.</p>
<p>The test will fail when a 2 bit sample from the TRNG is repeated an unusual amount of times within a window of 64 bits. The adaptive proportion test is further described in NIST-800-90B.</p>
<p>If an application detects this error then the TRNG should be reset. The adaptive proportion test over 64 samples is always enabled. </p>

<p>Definition at line <a class="el" href="trng_8h_source.html#l00103">103</a> of file <a class="el" href="trng_8h_source.html">trng.h</a>.</p>

</div>
</div>
<a class="anchor" id="gaa10b5a545120bfba4c93015b023c1ebb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MBEDTLS_ERR_TRNG_CONDITIONING_TEST_FAILED&#160;&#160;&#160;((int)<a class="el" href="mbedtls__ecode_8h.html#a427a9c812380331dc27621c07abcbbbb">MBEDTLS_ERR_TRNG_BASE</a> | 0x00000001)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Conditioning test failed. </p>

<p>Definition at line <a class="el" href="trng_8h_source.html#l00079">79</a> of file <a class="el" href="trng_8h_source.html">trng.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga22001b88271612caad4c2f36248ba242"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MBEDTLS_ERR_TRNG_NO_DATA&#160;&#160;&#160;((int)<a class="el" href="mbedtls__ecode_8h.html#a427a9c812380331dc27621c07abcbbbb">MBEDTLS_ERR_TRNG_BASE</a> | 0x00000002)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>No data received in the TRNG FIFO. </p>

<p>Definition at line <a class="el" href="trng_8h_source.html#l00082">82</a> of file <a class="el" href="trng_8h_source.html">trng.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga71bc27982f6fa984ad45daf6bc7f898f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MBEDTLS_ERR_TRNG_NOISE_ALARM&#160;&#160;&#160;((int)<a class="el" href="mbedtls__ecode_8h.html#a427a9c812380331dc27621c07abcbbbb">MBEDTLS_ERR_TRNG_BASE</a> | 0x00000006)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>AIS31 test noise alarm. </p>
<p>The AIS31 test is designed to monitor and verify the statistical distribution of the random numbers from the TRNG. The test performs 512 consecutive 128 bit X^2 calculations with 4 bit words. The details of the AIS31 test can be found in the AIS31 specification.</p>
<p>The test will fail when an unusual statistical distribution of the TRNG output is found.</p>
<p>If an application detects this error then the TRNG should be reset. The AIS31 test is always enabled. </p>

<p>Definition at line <a class="el" href="trng_8h_source.html#l00128">128</a> of file <a class="el" href="trng_8h_source.html">trng.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga39f2b36f88c3c5119e48d68d7059226a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MBEDTLS_ERR_TRNG_PRELIMINARY_NOISE_ALARM&#160;&#160;&#160;((int)<a class="el" href="mbedtls__ecode_8h.html#a427a9c812380331dc27621c07abcbbbb">MBEDTLS_ERR_TRNG_BASE</a> | 0x00000007)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>AIS31 test Preliminary Noise alarm. </p>
<p>The preliminary noise alarms generated from the same AIS31 test that generates <a class="el" href="group__sl__crypto__trng.html#ga71bc27982f6fa984ad45daf6bc7f898f">MBEDTLS_ERR_TRNG_NOISE_ALARM</a>. The difference between a preliminary noise alarm and a noise alarm is the severity and the expected frequency. A preliminary noise alarm will happen more frequently than a noise alarm, and a preliminary noise alarm is not considered critical. The preliminary noise alarm is not uncommon and should be expected from time to time when reading data from the TRNG.</p>
<p>If an application detects a preliminary noise alarm then the recommended action is to flush the TRNG FIFO, or reset the TRNG. </p>

<p>Definition at line <a class="el" href="trng_8h_source.html#l00140">140</a> of file <a class="el" href="trng_8h_source.html">trng.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga212f3d8f9ff4bcb5de2ec09a38b4cbc3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MBEDTLS_ERR_TRNG_REPETITION_COUNT_TEST_FAILED&#160;&#160;&#160;((int)<a class="el" href="mbedtls__ecode_8h.html#a427a9c812380331dc27621c07abcbbbb">MBEDTLS_ERR_TRNG_BASE</a> | 0x00000003)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Repetition Count test failed. </p>
<p>The repetition count test fails when the TRNG detects that the output become "stuck" on a single value for a long period of time. The repetition count test is described in NIST-800-90B.</p>
<p>If an application detects this error then the TRNG should be reset. The repetition count test is always enabled. </p>

<p>Definition at line <a class="el" href="trng_8h_source.html#l00090">90</a> of file <a class="el" href="trng_8h_source.html">trng.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga987bc2a769eca92ef81c865e95f26fb8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_trng_check_conditioning </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__trng__context.html">mbedtls_trng_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check the TRNG conditioning function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>TRNG context</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if success. <a class="el" href="group__sl__crypto__trng.html#gaa10b5a545120bfba4c93015b023c1ebb">MBEDTLS_ERR_TRNG_CONDITIONING_TEST_FAILED</a> on failure. </dd></dl>

</div>
</div>
<a class="anchor" id="ga9dc92e7f58972d20cff0738a8eb404ec"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_trng_check_entropy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__trng__context.html">mbedtls_trng_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check the TRNG entropy source is producing random data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>TRNG context</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if success. Error code if failure. </dd></dl>

</div>
</div>
<a class="anchor" id="ga105f7fb57c7a0843f4b750c54636c53b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mbedtls_trng_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__trng__context.html">mbedtls_trng_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Free TRNG context. </p>
<p>This function will disable the TRNG0 peripheral by stopping the TRNG0 clock. If more than one TRNG contexts are instantiated the user should be aware that one call to mbedtls_trng_free with any of the trng contexts will disable the TRNG0 and effectively disable all other calls in the TRNG API, except mbedtls_trng_init which will enable the TRNG0 again. Normally the application will need only one TRNG context.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>TRNG context to be released </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga846a87535364a7764897e35dcd362401"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mbedtls_trng_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__trng__context.html">mbedtls_trng_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize TRNG context. </p>
<p>This function will enable the TRNG0 peripheral by starting the TRNG0 clock, initializing the control register, perform soft reset and wait until data is available in the FIFO. Normally the application will need only one TRNG context. If more than one TRNG contexts are instantiated the user should be aware that mbedtls_trng_free will disable the TRNG0 by stopping the clock, requiring mbedtls_trng_init to be called again before any TRNG API calls can be used. When the TRNG module is used as a standard mbedtls entropy source the context passed to void <a class="el" href="entropy__alt_8h.html#aa901e027093c6fe65dee5760db78aced" title="Initialize the context. ">mbedtls_entropy_init( mbedtls_entropy_context *ctx )</a> will include one TRNG context and initialize it. The application should not want to keep more than one <a class="el" href="structmbedtls__entropy__context.html" title="Entropy context structure. ">mbedtls_entropy_context</a> structures as it will consume memory.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>TRNG context to be initialized </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="gac8319b2bf9b23885f5401a98f0d16db1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_trng_poll </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__trng__context.html">mbedtls_trng_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>olen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Poll for entropy data. </p>
<p>This function will read available random data from the TRNG FIFO and place it into the output buffer. The len parameter tells this function the maximum number of bytes to read.</p>
<p>Note that the number of bytes read from the TRNG might differ from the number of bytes requested. If any alarms are signaled or the TRNG FIFO is empty then this function will return early.</p>
<p>The return value should be used to see if the operation was successful of if an alarm was encountered while reading the FIFO. The content of the olen parameter can be used to check how many bytes were actually read.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>TRNG context </td></tr>
    <tr><td class="paramname">output</td><td>Buffer to fill with data from the TRNG </td></tr>
    <tr><td class="paramname">len</td><td>Maximum number of bytes to fill in output buffer. </td></tr>
    <tr><td class="paramname">olen</td><td>The actual amount of bytes put into the buffer (Can be 0)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>0 if no critical failures occurred, </li>
<li>MBEDTLS_ERR_TRNG_PRELIMINARY_NOISE_ALARM if a AIS31 preliminary noise alarm was detected while reading the FIFO, </li>
<li>MBEDTLS_ERR_TRNG_NOISE_ALARM if an AIS31 noise alarm was detected. </li>
<li>MBEDTLS_ERR_TRNG_REPETITION_COUNT_TEST_FAILED if the repetition count test failed while reading the FIFO. </li>
<li>MBEDTLS_ERR_TRNG_ADAPTIVE_PROPORTION_TEST_64_FAILED if the adaptive proportion test over 64 samples failed while reading the FIFO. </li>
<li>MBEDTLS_ERR_TRNG_ADAPTIVE_PROPORTION_TEST_4096_FAILED if the adaptive proportion test over 4096 samples failed while reading from the FIFO. </li>
</ul>
</dd></dl>

</div>
</div>
<a class="anchor" id="ga7ad4ef01d236b535ab156175708f1eeb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_trng_set_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__trng__context.html">mbedtls_trng_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check the TRNG conditioning function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>TRNG context </td></tr>
    <tr><td class="paramname">key</td><td>128-bit AES key</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if success. Error code if failure. </dd></dl>

</div>
</div>
<a class="anchor" id="ga76cbaf4739ffb9abfb88f341c6918548"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mbedtls_trng_soft_reset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__trng__context.html">mbedtls_trng_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Execute TRNG soft reset. </p>
<p>This function performs a TRNG soft reset. The TRNG soft reset can be used to clear error conditions such as Noise Alarms, etc.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>TRNG context </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Mar 9 2017 20:48:05 for mbed TLS v2.2.0 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
