<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>mbed TLS v2.2.0: CBC-MAC (CCM) for 128-bit block ciphers</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">mbed TLS v2.2.0
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="../../index.html"><span>Documentation&#160;Home</span></a></li>
      <li><a href="http://www.silabs.com"><span>silabs.com</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">CBC-MAC (CCM) for 128-bit block ciphers<div class="ingroups"><a class="el" href="group__sl__crypto.html">Silicon Labs CRYPTO Hardware Acceleration Plugins</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>CRYPTO hardware accelerated counter with CBC-MAC (CCM) for 128-bit block ciphers. </p>
<div class="dynheader">
Collaboration diagram for CBC-MAC (CCM) for 128-bit block ciphers:</div>
<div class="dyncontent">
<center><table><tr><td><img src="group__sl__crypto__ccm.png" border="0" alt="" usemap="#group____sl____crypto____ccm"/>
<map name="group____sl____crypto____ccm" id="group____sl____crypto____ccm">
<area shape="rect" id="node2" href="group__sl__crypto.html" title="mbed TLS plugins (for AES, CCM, ECC, SHA) from SiliconLabs with hardware acceleration. " alt="" coords="6,5,162,61"/>
</map>
</td></tr></table></center>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmbedtls__ccm__context.html">mbedtls_ccm_context</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">CCM context structure.  <a href="structmbedtls__ccm__context.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gabaeb0629dfac72016fda58a4f7870040"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sl__crypto__ccm.html#gabaeb0629dfac72016fda58a4f7870040">mbedtls_ccm_init</a> (<a class="el" href="structmbedtls__ccm__context.html">mbedtls_ccm_context</a> *ctx)</td></tr>
<tr class="memdesc:gabaeb0629dfac72016fda58a4f7870040"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize CCM context (just makes references valid) Makes the context ready for <a class="el" href="group__sl__crypto__ccm.html#ga464d8e724738b4bbd5b415ca0580f1b1" title="CCM initialization (encryption and decryption) ">mbedtls_ccm_setkey()</a> or <a class="el" href="group__sl__crypto__ccm.html#ga2bd8130a83c6633a4dfd61b181cdabac" title="Free a CCM context and underlying cipher sub-context. ">mbedtls_ccm_free()</a>.  <a href="#gabaeb0629dfac72016fda58a4f7870040">More...</a><br /></td></tr>
<tr class="separator:gabaeb0629dfac72016fda58a4f7870040"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac5fedddc015038d4e2f5d3c7e8590b09"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sl__crypto__ccm.html#gac5fedddc015038d4e2f5d3c7e8590b09">mbedtls_ccm_set_device_instance</a> (<a class="el" href="structmbedtls__ccm__context.html">mbedtls_ccm_context</a> *ctx, int devno)</td></tr>
<tr class="memdesc:gac5fedddc015038d4e2f5d3c7e8590b09"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the device instance of an CCM context.  <a href="#gac5fedddc015038d4e2f5d3c7e8590b09">More...</a><br /></td></tr>
<tr class="separator:gac5fedddc015038d4e2f5d3c7e8590b09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5e0da222314d667d6cc5e2cfc33b13ae"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sl__crypto__ccm.html#ga5e0da222314d667d6cc5e2cfc33b13ae">mbedtls_ccm_set_device_io_mode</a> (<a class="el" href="structmbedtls__ccm__context.html">mbedtls_ccm_context</a> *ctx, <a class="el" href="sl__crypto_8h.html#a0db512d40860e61bd11571a2204897b8">mbedtls_device_io_mode</a> mode, <a class="el" href="unionmbedtls__device__io__mode__specific.html">mbedtls_device_io_mode_specific</a> *specific)</td></tr>
<tr class="memdesc:ga5e0da222314d667d6cc5e2cfc33b13ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the device I/O mode of an CCM context.  <a href="#ga5e0da222314d667d6cc5e2cfc33b13ae">More...</a><br /></td></tr>
<tr class="separator:ga5e0da222314d667d6cc5e2cfc33b13ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga464d8e724738b4bbd5b415ca0580f1b1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sl__crypto__ccm.html#ga464d8e724738b4bbd5b415ca0580f1b1">mbedtls_ccm_setkey</a> (<a class="el" href="structmbedtls__ccm__context.html">mbedtls_ccm_context</a> *ctx, <a class="el" href="cipher_8h.html#af5b069ffd0b2ad31225e42ee4ee29b1b">mbedtls_cipher_id_t</a> cipher, const unsigned char *key, unsigned int keybits)</td></tr>
<tr class="memdesc:ga464d8e724738b4bbd5b415ca0580f1b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">CCM initialization (encryption and decryption)  <a href="#ga464d8e724738b4bbd5b415ca0580f1b1">More...</a><br /></td></tr>
<tr class="separator:ga464d8e724738b4bbd5b415ca0580f1b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2bd8130a83c6633a4dfd61b181cdabac"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sl__crypto__ccm.html#ga2bd8130a83c6633a4dfd61b181cdabac">mbedtls_ccm_free</a> (<a class="el" href="structmbedtls__ccm__context.html">mbedtls_ccm_context</a> *ctx)</td></tr>
<tr class="memdesc:ga2bd8130a83c6633a4dfd61b181cdabac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free a CCM context and underlying cipher sub-context.  <a href="#ga2bd8130a83c6633a4dfd61b181cdabac">More...</a><br /></td></tr>
<tr class="separator:ga2bd8130a83c6633a4dfd61b181cdabac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga64de697edfefbff94d7eb0d9a8de926f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sl__crypto__ccm.html#ga64de697edfefbff94d7eb0d9a8de926f">mbedtls_ccm_encrypt_and_tag</a> (<a class="el" href="structmbedtls__ccm__context.html">mbedtls_ccm_context</a> *ctx, size_t length, const unsigned char *iv, size_t iv_len, const unsigned char *add, size_t add_len, const unsigned char *input, unsigned char *output, unsigned char *tag, size_t tag_len)</td></tr>
<tr class="memdesc:ga64de697edfefbff94d7eb0d9a8de926f"><td class="mdescLeft">&#160;</td><td class="mdescRight">CCM buffer encryption.  <a href="#ga64de697edfefbff94d7eb0d9a8de926f">More...</a><br /></td></tr>
<tr class="separator:ga64de697edfefbff94d7eb0d9a8de926f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8dc9dfe246064185498f005d8bf22622"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sl__crypto__ccm.html#ga8dc9dfe246064185498f005d8bf22622">mbedtls_ccm_auth_decrypt</a> (<a class="el" href="structmbedtls__ccm__context.html">mbedtls_ccm_context</a> *ctx, size_t length, const unsigned char *iv, size_t iv_len, const unsigned char *add, size_t add_len, const unsigned char *input, unsigned char *output, const unsigned char *tag, size_t tag_len)</td></tr>
<tr class="memdesc:ga8dc9dfe246064185498f005d8bf22622"><td class="mdescLeft">&#160;</td><td class="mdescRight">CCM buffer authenticated decryption.  <a href="#ga8dc9dfe246064185498f005d8bf22622">More...</a><br /></td></tr>
<tr class="separator:ga8dc9dfe246064185498f005d8bf22622"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaac6098e700eae550d1b5eab9813f1240"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sl__crypto__ccm.html#gaac6098e700eae550d1b5eab9813f1240">mbedtls_ccm_encrypt_and_tag_ble</a> (<a class="el" href="structmbedtls__ccm__context.html">mbedtls_ccm_context</a> *ctx, unsigned char *data, size_t length, const unsigned char *iv, unsigned char header, unsigned char *tag)</td></tr>
<tr class="memdesc:gaac6098e700eae550d1b5eab9813f1240"><td class="mdescLeft">&#160;</td><td class="mdescRight">CCM buffer encryption optimized for BLE.  <a href="#gaac6098e700eae550d1b5eab9813f1240">More...</a><br /></td></tr>
<tr class="separator:gaac6098e700eae550d1b5eab9813f1240"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaafd2f8c9f866b29982882ee885a9f295"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sl__crypto__ccm.html#gaafd2f8c9f866b29982882ee885a9f295">mbedtls_ccm_auth_decrypt_ble</a> (<a class="el" href="structmbedtls__ccm__context.html">mbedtls_ccm_context</a> *ctx, unsigned char *data, size_t length, const unsigned char *iv, unsigned char header, unsigned char *tag)</td></tr>
<tr class="memdesc:gaafd2f8c9f866b29982882ee885a9f295"><td class="mdescLeft">&#160;</td><td class="mdescRight">CCM buffer authenticated decryption optimized for BLE.  <a href="#gaafd2f8c9f866b29982882ee885a9f295">More...</a><br /></td></tr>
<tr class="separator:gaafd2f8c9f866b29982882ee885a9f295"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga8dc9dfe246064185498f005d8bf22622"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ccm_auth_decrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ccm__context.html">mbedtls_ccm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>iv_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>add</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>add_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>tag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>tag_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>CCM buffer authenticated decryption. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>CCM context </td></tr>
    <tr><td class="paramname">length</td><td>length of the input data </td></tr>
    <tr><td class="paramname">iv</td><td>initialization vector </td></tr>
    <tr><td class="paramname">iv_len</td><td>length of IV </td></tr>
    <tr><td class="paramname">add</td><td>additional data </td></tr>
    <tr><td class="paramname">add_len</td><td>length of additional data </td></tr>
    <tr><td class="paramname">input</td><td>buffer holding the input data </td></tr>
    <tr><td class="paramname">output</td><td>buffer for holding the output data </td></tr>
    <tr><td class="paramname">tag</td><td>buffer holding the tag </td></tr>
    <tr><td class="paramname">tag_len</td><td>length of the tag</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful and authenticated, MBEDTLS_ERR_CCM_AUTH_FAILED if tag does not match </dd></dl>

</div>
</div>
<a class="anchor" id="gaafd2f8c9f866b29982882ee885a9f295"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ccm_auth_decrypt_ble </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ccm__context.html">mbedtls_ccm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>header</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>tag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>CCM buffer authenticated decryption optimized for BLE. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>CCM context </td></tr>
    <tr><td class="paramname">data</td><td>Input/output buffer of payload data of BLE packet </td></tr>
    <tr><td class="paramname">length</td><td>length of input data </td></tr>
    <tr><td class="paramname">iv</td><td>nonce (initialization vector) must be 13 bytes </td></tr>
    <tr><td class="paramname">header</td><td>header of BLE packet (1 byte) </td></tr>
    <tr><td class="paramname">tag</td><td>authentication tag of BLE packet (4 bytes)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful and authenticated, MBEDTLS_ERR_CCM_AUTH_FAILED if tag does not match payload </dd></dl>

</div>
</div>
<a class="anchor" id="ga64de697edfefbff94d7eb0d9a8de926f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ccm_encrypt_and_tag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ccm__context.html">mbedtls_ccm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>iv_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>add</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>add_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>tag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>tag_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>CCM buffer encryption. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>CCM context </td></tr>
    <tr><td class="paramname">length</td><td>length of the input data in bytes </td></tr>
    <tr><td class="paramname">iv</td><td>nonce (initialization vector) </td></tr>
    <tr><td class="paramname">iv_len</td><td>length of IV in bytes must be 2, 3, 4, 5, 6, 7 or 8 </td></tr>
    <tr><td class="paramname">add</td><td>additional data </td></tr>
    <tr><td class="paramname">add_len</td><td>length of additional data in bytes must be less than 2^16 - 2^8 </td></tr>
    <tr><td class="paramname">input</td><td>buffer holding the input data </td></tr>
    <tr><td class="paramname">output</td><td>buffer for holding the output data must be at least 'length' bytes wide </td></tr>
    <tr><td class="paramname">tag</td><td>buffer for holding the tag </td></tr>
    <tr><td class="paramname">tag_len</td><td>length of the tag to generate in bytes must be 4, 6, 8, 10, 14 or 16</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The tag is written to a separate buffer. To get the tag concatenated with the output as in the CCM spec, use tag = output + length and make sure the output buffer is at least length + tag_len wide.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful </dd></dl>

</div>
</div>
<a class="anchor" id="gaac6098e700eae550d1b5eab9813f1240"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ccm_encrypt_and_tag_ble </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ccm__context.html">mbedtls_ccm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>header</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>tag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>CCM buffer encryption optimized for BLE. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>CCM context </td></tr>
    <tr><td class="paramname">data</td><td>Input/output buffer of payload data of BLE packet </td></tr>
    <tr><td class="paramname">length</td><td>length of input data </td></tr>
    <tr><td class="paramname">iv</td><td>nonce (initialization vector) must be 13 bytes </td></tr>
    <tr><td class="paramname">header</td><td>header of BLE packet (1 byte) </td></tr>
    <tr><td class="paramname">tag</td><td>buffer where the BLE packet tag (4 bytes) will be written</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful </dd></dl>

</div>
</div>
<a class="anchor" id="ga2bd8130a83c6633a4dfd61b181cdabac"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mbedtls_ccm_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ccm__context.html">mbedtls_ccm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Free a CCM context and underlying cipher sub-context. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>CCM context to free </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="gabaeb0629dfac72016fda58a4f7870040"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mbedtls_ccm_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ccm__context.html">mbedtls_ccm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize CCM context (just makes references valid) Makes the context ready for <a class="el" href="group__sl__crypto__ccm.html#ga464d8e724738b4bbd5b415ca0580f1b1" title="CCM initialization (encryption and decryption) ">mbedtls_ccm_setkey()</a> or <a class="el" href="group__sl__crypto__ccm.html#ga2bd8130a83c6633a4dfd61b181cdabac" title="Free a CCM context and underlying cipher sub-context. ">mbedtls_ccm_free()</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>CCM context to initialize </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="gac5fedddc015038d4e2f5d3c7e8590b09"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ccm_set_device_instance </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ccm__context.html">mbedtls_ccm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>devno</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the device instance of an CCM context. </p>
<p>This function sets the AES/CRYPTO device instance of an CCM context. Subsequent calls to CCM API functions with this context will use the new AES/CRYPTO device instance.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>CCM device context.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">devno</td><td>AES/CRYPTO hardware device instance to use.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if success. Error code if failure, see <a class="el" href="ccm_8h.html">ccm.h</a>. </dd></dl>

</div>
</div>
<a class="anchor" id="ga5e0da222314d667d6cc5e2cfc33b13ae"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ccm_set_device_io_mode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ccm__context.html">mbedtls_ccm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sl__crypto_8h.html#a0db512d40860e61bd11571a2204897b8">mbedtls_device_io_mode</a>&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="unionmbedtls__device__io__mode__specific.html">mbedtls_device_io_mode_specific</a> *&#160;</td>
          <td class="paramname"><em>specific</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the device I/O mode of an CCM context. </p>
<p>This function sets the device data I/O mode of an CCM context. The data can be moved by Core CPU, DMA or BUFC between CRYPTO and RAM.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>CCM device context.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mode</td><td>I/O mode (Core CPU, DMA or BUFC).</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">specific</td><td>I/O mode specific configuration mbedtls_ccm_io_mode_specific.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>If BUFC is selected (<a class="el" href="sl__crypto_8h.html#a0db512d40860e61bd11571a2204897b8a9a402497d0fb9085ee908764fed36461">MBEDTLS_DEVICE_IO_MODE_BUFC</a>), this function does not enable the BUFC clock and does not do any global BUFC initialization. I.e. the user is responsible for performing BUFC initialization prior to calling this function. If DMA is selected (MBEDTLS_DEVICE_IO_MODE_DMA), this function performs full DMA driver initialization by calling DMADRV_Init (non-destructive) and allocates DMA channel resources to be used by CCM.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>0 if success. Error code if failure, see <a class="el" href="ccm_8h.html">ccm.h</a>. </dd></dl>

</div>
</div>
<a class="anchor" id="ga464d8e724738b4bbd5b415ca0580f1b1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_ccm_setkey </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__ccm__context.html">mbedtls_ccm_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cipher_8h.html#af5b069ffd0b2ad31225e42ee4ee29b1b">mbedtls_cipher_id_t</a>&#160;</td>
          <td class="paramname"><em>cipher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>keybits</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>CCM initialization (encryption and decryption) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>CCM context to be initialized </td></tr>
    <tr><td class="paramname">cipher</td><td>cipher to use (a 128-bit block cipher) </td></tr>
    <tr><td class="paramname">key</td><td>encryption key </td></tr>
    <tr><td class="paramname">keybits</td><td>key size in bits (must be acceptable by the cipher)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or a cipher specific error code </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Jun 13 2016 11:17:24 for mbed TLS v2.2.0 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
